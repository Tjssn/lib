% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Main_TJ_word.R
\name{TJword}
\alias{TJword}
\title{TJword}
\usage{
TJword(
  model_list = NULL,
  data_list = NULL,
  output_path,
  table_comments = NULL,
  introduction = "",
  text_comments = NULL,
  text.title.size = 14,
  text.intro.size = 12,
  text.textcom.size = 12,
  text.table.caption.size = 12,
  text.table.content.size = 11,
  text.table.note.size = 10,
  line.title.spacing = 1,
  line.intro.spacing = 1.5,
  line.textcom.spacing = 1.5,
  line.caption.spacing = 1,
  line.table.note.spacing = 1.5,
  text.title.family = "Times New Roman",
  text.intro.family = "Times New Roman",
  text.textcom.family = "Times New Roman",
  text.table.caption.family = "Times New Roman",
  text.table.content.family = "Times New Roman",
  text.table.note.family = "Times New Roman",
  pad.table.cell = 1
)
}
\arguments{
\item{model_list}{列表，可选参数。包含表格数据和默认文本参数的模型对象，需满足特定结构：
\itemize{
\item \code{result$table$model.res}：存储表格数据的列表（格式同\code{data_list}）；
\item \code{result$output.infor$my_annotations}：默认表注（格式同\code{table_comments}）；
\item \code{result$output.infor$introduction}：默认正文（格式同\code{introduction}）；
\item \code{result$output.infor$text_comments}：默认表格前置说明（格式同\code{text_comments}）。
若未手动传入\code{data_list}/\code{table_comments}/\code{introduction}/\code{text_comments}，函数将从该对象提取默认值。
}}

\item{data_list}{列表，可选参数。存储待插入Word表格的列表，每个元素为一个数据框（data.frame），
列表名称即为表格名称（将显示在表格标题中），格式为\code{list("表格1名称" = 数据框1, "表格2名称" = 数据框2)}。
若与\code{model_list}同时提供，\code{data_list}优先级低于\code{model_list$result$table$model.res}（即优先使用模型对象中的表格数据）。}

\item{output_path}{字符型，必填参数。Word文档的输出路径（含文件名），格式需为\code{.docx}，例如\code{"D:/GBTM报告.docx"}。}

\item{table_comments}{列表，可选参数。存储表注内容的命名列表，列表名称需与\code{data_list}/\code{model_list}中的表格名称一致，
格式为\code{list("表格1名称" = "表1注释放置", "表格2名称" = "表2注释放置")}。用户手动传入时，优先级高于\code{model_list}中的默认表注。}

\item{introduction}{报告正文内容，支持包含统计分析背景、数据来源、分析方法等描述性文本，
函数会自动为正文添加首行缩进。用户手动传入时，优先级高于\code{model_list}中的默认正文。}

\item{text_comments}{列表，可选参数。存储表格前置说明的命名列表，列表名称需与\code{data_list}/\code{model_list}中的表格名称一致，
用于在对应表格标题前添加说明文本（如表格核心内容、数据含义等），格式为\code{list("表格1名称" = "表1前置说明", "表格2名称" = "表2前置说明")}。
用户手动传入时，优先级高于\code{model_list}中的默认表格前置说明。}

\item{text.title.size}{报告标题的字号，默认值为14（单位：磅），对应参数含义为“文本.报告标题.字号”。}

\item{text.intro.size}{报告正文的字号，默认值为12（单位：磅），对应参数含义为“文本.正文.字号”。}

\item{text.textcom.size}{表格前置说明的字号，默认值为12（单位：磅），对应参数含义为“文本.表格前置说明.字号”。}

\item{text.table.caption.size}{表格标题的字号，默认值为12（单位：磅），对应参数含义为“文本.表格标题.字号”。}

\item{text.table.content.size}{表格内容（含表头）的字号，默认值为11（单位：磅），对应参数含义为“文本.表格内容.字号”。}

\item{text.table.note.size}{表注的字号，默认值为10（单位：磅），对应参数含义为“文本.表注.字号”。}

\item{line.title.spacing}{报告标题的行距倍数，默认值为1.0（单倍行距），对应参数含义为“行距.报告标题.行距”。}

\item{line.intro.spacing}{报告正文的行距倍数，默认值为1.5（1.5倍行距），对应参数含义为“行距.正文.行距”。}

\item{line.textcom.spacing}{表格前置说明的行距倍数，默认值为1.5（1.5倍行距），对应参数含义为“行距.表格前置说明.行距”。}

\item{line.caption.spacing}{表格标题的行距倍数，默认值为1.0（单倍行距），对应参数含义为“行距.表格标题.行距”。}

\item{line.table.note.spacing}{表注的行距倍数，默认值为1.5（1.5倍行距），对应参数含义为“行距.表注.行距”。}

\item{text.title.family}{报告标题的字体类型，默认值为\code{"Times New Roman"}，对应参数含义为“文本.报告标题.字体”。}

\item{text.intro.family}{报告正文的字体类型，默认值为\code{"Times New Roman"}，对应参数含义为“文本.正文.字体”。}

\item{text.textcom.family}{表格前置说明的字体类型，默认值为\code{"Times New Roman"}，对应参数含义为“文本.表格前置说明.字体”。}

\item{text.table.caption.family}{表格标题的字体类型，默认值为\code{"Times New Roman"}，对应参数含义为“文本.表格标题.字体”。}

\item{text.table.content.family}{表格内容的字体类型，默认值为\code{"Times New Roman"}，对应参数含义为“文本.表格内容.字体”。}

\item{text.table.note.family}{表注的字体类型，默认值为\code{"Times New Roman"}，对应参数含义为“文本.表注.字体”。}

\item{pad.table.cell}{表格单元格的内边距（即单元格内容与边框的距离），默认值为1（单位：磅），
对应参数含义为“内边距.表格单元格.内边距”，值越小表格越紧凑。}
}
\description{
从数据列表或模型对象中提取信息，生成标准化Word格式统计分析报告，支持报告标题、正文、表格前置说明、
三线表格式表格、表注的完整内容构建，并提供灵活的格式自定义功能（字体类型、字号、行距、表格内边距）。
函数支持参数优先级控制（用户自定义参数优先于模型对象默认参数），自动生成符合学术规范的三线表，
最终在指定路径输出可直接使用的Word文档，并在控制台提示保存路径，便于后续报告整理与分享。
}
\details{
函数处理流程与参数优先级逻辑：\cr
\enumerate{
\item 数据与文本参数提取：先尝试从\code{model_list}提取表格数据（\code{result$table$model.res}）和默认文本（正文/前置说明/表注），
若用户手动传入\code{data_list}/\code{table_comments}/\code{introduction}/\code{text_comments}，则覆盖默认值；\cr
\item 报告结构构建：按“报告标题 → 正文 → （分页 → 表格前置说明 → 表格标题 → 三线表 → 表注）×N”的顺序生成内容，
其中N为表格数量，从第二个表格开始自动分页；\cr
\item 格式应用：标题默认居中加粗，正文默认首行缩进，表格默认三线表（上粗线1.5pt、中细线0.75pt、下粗线1.5pt），
所有格式参数（字体/字号/行距/内边距）均通过“见名知意”的参数控制，默认值符合学术报告规范；\cr
\item 文档输出：在指定路径生成Word文档，控制台打印保存路径，无显式返回值。
}
}
\note{
\enumerate{
\item 若需修改表格边框样式（如调整线条粗细、颜色），需在函数内\code{生成表格}模块修改\code{fp_border}的\code{width}和\code{color}参数；\cr
\item 正文首行缩进由函数自动添加（通过\code{paste0("\\t", final_introduction)}实现），无需在\code{introduction}参数中手动添加空格；\cr
\item 表格名称需避免包含特殊字符（如\verb{/ \\ : * ? " < > |}），否则可能导致表格标题显示异常或文档保存失败；\cr
\item 若\code{model_list}结构不符合要求（如缺少\code{result$table$model.res}），函数将优先尝试使用\code{data_list}，二者均无则报错。
}
}
\section{重要提示}{

\strong{⚠️} 函数参数存在明确优先级关系：用户手动传入的\code{table_comments}/\code{introduction}/\code{text_comments}
优先于\code{model_list}中提取的默认参数；若未传入\code{data_list}，将从\code{model_list}的\code{result$table$model.res}提取表格数据，
二者均未提供时会报错。生成的表格默认采用学术规范三线表格式，若需调整表格边框样式，需手动修改函数内表格处理逻辑。
请确保输出路径（\code{output_path}）具备写入权限，否则会导致Word文档保存失败。
}

\examples{
TJword(
  model_list = GBTM_Model2,
  output_path = "A23.docx",
  introduction="本报告呈现了基于潜在类别增长模型(GBTM)的统计分析结果。分析数据来源于标准化收集的样本群体(n=500)，通过模型拟合得到3个不同类别的增长轨迹特征(低增长组、中增长组、高增长组)。报告包含模型拟合优度指标、类别划分结果及关键参数估计值，可为后续干预策略制定提供参考依据。所有分析均采用p < 0.05作为统计显著性水平，使用R软件(flexmix包)完成数据处理与模型构建。",
  text_comments=c("组轨迹模型的拟合效果评价指标1"="本研究结果显示, OCC AVEPP 等指标均符合建模标准，进一步查看Table2 组轨迹模型的拟合效果评价指标1。")
)
TJword(
  data_list = GBTM_Model2$result$table$model.res,
  output_path = "DATAA23.docx"
)
}
\author{
开发团队:统计碎碎念团队;\cr
联系方式:VX:Tongjissn;\cr
官方平台-公众号:统计碎碎念
}
